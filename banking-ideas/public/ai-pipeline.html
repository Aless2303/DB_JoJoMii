<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BANK//IDEAS - AI Pipeline Visualizer</title>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <style>
        :root {
            --cyan: #00ffff;
            --yellow: #ffff00;
            --magenta: #ff00ff;
            --green: #00ff00;
            --red: #ff0000;
            --white: #ffffff;
            --bg-dark: #000033;
            --bg-darker: #000022;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'VT323', monospace;
            background: var(--bg-dark);
            color: var(--white);
            min-height: 100vh;
            overflow-x: auto;
            position: relative;
        }

        /* Scanlines effect */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 0, 0, 0.15),
                rgba(0, 0, 0, 0.15) 1px,
                transparent 1px,
                transparent 2px
            );
            pointer-events: none;
            z-index: 1000;
        }

        /* CRT flicker */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 255, 255, 0.02);
            pointer-events: none;
            z-index: 999;
            animation: flicker 0.15s infinite;
        }

        @keyframes flicker {
            0% { opacity: 0.97; }
            50% { opacity: 1; }
            100% { opacity: 0.98; }
        }

        /* Header */
        .header {
            background: linear-gradient(180deg, var(--bg-darker) 0%, transparent 100%);
            border-bottom: 3px double var(--cyan);
            padding: 12px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            color: var(--cyan);
            text-shadow: 0 0 10px var(--cyan), 0 0 20px var(--cyan);
            letter-spacing: 2px;
        }

        .logo span {
            color: var(--yellow);
        }

        .page-number {
            background: var(--red);
            color: var(--white);
            padding: 5px 15px;
            font-size: 22px;
            font-weight: bold;
        }

        .header-info {
            color: var(--yellow);
            font-size: 16px;
            text-align: center;
        }

        /* Main container */
        .main-container {
            display: flex;
            flex-direction: column;
            min-height: calc(100vh - 130px);
        }

        /* Pipeline area */
        .pipeline-area {
            flex: 1;
            padding: 30px;
            position: relative;
            overflow-x: auto;
            overflow-y: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Pipeline horizontal layout */
        .pipeline-stages {
            display: flex;
            align-items: center;
            gap: 15px;
            position: relative;
            z-index: 2;
            min-width: max-content;
            padding: 20px 0;
        }

        .stage-column {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .stage-label {
            color: var(--magenta);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .parallel-box {
            background: rgba(255, 0, 255, 0.08);
            border: 2px dashed var(--magenta);
            border-radius: 10px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            position: relative;
        }

        .parallel-box::before {
            content: 'PARALLEL (Promise.all)';
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-dark);
            color: var(--magenta);
            padding: 0 8px;
            font-size: 11px;
            white-space: nowrap;
        }

        /* Arrow between stages */
        .stage-arrow {
            color: var(--cyan);
            font-size: 32px;
            opacity: 0.5;
            margin: 0 5px;
            transition: all 0.3s ease;
        }

        .stage-arrow.active {
            color: var(--yellow);
            opacity: 1;
            text-shadow: 0 0 15px var(--yellow);
            animation: arrow-pulse 0.5s infinite;
        }

        .stage-arrow.complete {
            color: var(--green);
            opacity: 1;
            text-shadow: 0 0 10px var(--green);
        }

        @keyframes arrow-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        /* Node styles */
        .node {
            background: var(--bg-darker);
            border: 2px solid var(--cyan);
            border-radius: 6px;
            padding: 12px 15px;
            width: 160px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .node:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(0, 255, 255, 0.3);
        }

        .node.selected {
            border-color: var(--yellow);
            box-shadow: 0 0 15px var(--yellow), inset 0 0 15px rgba(255, 255, 0, 0.1);
        }

        .node.running {
            border-color: var(--yellow);
            animation: pulse 0.5s ease-in-out infinite;
        }

        .node.complete {
            border-color: var(--green);
            box-shadow: 0 0 10px var(--green);
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 5px var(--yellow); }
            50% { box-shadow: 0 0 25px var(--yellow), 0 0 40px var(--yellow); }
        }

        .node-icon {
            font-size: 24px;
            text-align: center;
            margin-bottom: 6px;
        }

        .node-title {
            font-size: 13px;
            color: var(--cyan);
            text-align: center;
            margin-bottom: 4px;
            text-transform: uppercase;
            line-height: 1.2;
        }

        .node-subtitle {
            font-size: 11px;
            color: var(--yellow);
            text-align: center;
            opacity: 0.8;
        }

        .node-phase {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--magenta);
            color: var(--white);
            padding: 1px 6px;
            font-size: 10px;
            border-radius: 3px;
        }

        .node-status {
            position: absolute;
            bottom: -6px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            padding: 1px 8px;
            border-radius: 8px;
            background: var(--bg-darker);
            border: 1px solid currentColor;
            white-space: nowrap;
        }

        .node-status.waiting { color: #888; }
        .node-status.running { color: var(--yellow); }
        .node-status.complete { color: var(--green); }

        .node.input-node {
            border-color: var(--green);
            background: linear-gradient(135deg, var(--bg-darker) 0%, rgba(0, 255, 0, 0.1) 100%);
        }

        .node.output-node {
            border-color: var(--magenta);
            background: linear-gradient(135deg, var(--bg-darker) 0%, rgba(255, 0, 255, 0.1) 100%);
        }

        /* Side panel (bottom) */
        .side-panel {
            width: 100%;
            max-height: 0;
            background: var(--bg-darker);
            border-top: 3px solid var(--cyan);
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .side-panel.open {
            max-height: 380px;
            overflow-y: auto;
        }

        .panel-inner {
            padding: 20px 30px;
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--cyan);
        }

        .panel-title {
            font-size: 22px;
            color: var(--cyan);
        }

        .panel-close {
            background: var(--red);
            border: none;
            color: var(--white);
            font-family: 'VT323', monospace;
            font-size: 18px;
            padding: 4px 12px;
            cursor: pointer;
        }

        .panel-content {
            display: grid;
            grid-template-columns: 1fr 1.5fr;
            gap: 25px;
        }

        .panel-section {
            margin-bottom: 15px;
        }

        .panel-section-title {
            color: var(--yellow);
            font-size: 16px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .panel-section-title::before {
            content: '‚ñ∫';
            color: var(--magenta);
        }

        .code-block {
            background: #000;
            border: 1px solid var(--cyan);
            border-radius: 4px;
            padding: 12px;
            overflow-x: auto;
            font-size: 12px;
            line-height: 1.4;
            max-height: 220px;
            overflow-y: auto;
        }

        .code-block code {
            color: var(--green);
            white-space: pre;
        }

        .info-list {
            list-style: none;
        }

        .info-list li {
            padding: 6px 0;
            border-bottom: 1px dashed rgba(0, 255, 255, 0.3);
            display: flex;
            justify-content: space-between;
            font-size: 14px;
        }

        .info-list li:last-child {
            border-bottom: none;
        }

        .info-label { color: var(--cyan); }
        .info-value { color: var(--yellow); }

        .panel-description {
            color: var(--white);
            line-height: 1.5;
            font-size: 14px;
            margin-bottom: 15px;
        }

        /* Footer */
        .footer {
            background: var(--bg-darker);
            border-top: 3px double var(--cyan);
            padding: 10px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            bottom: 0;
            z-index: 100;
        }

        .run-button {
            background: linear-gradient(180deg, var(--green) 0%, #009900 100%);
            border: 2px solid var(--green);
            color: var(--bg-dark);
            font-family: 'VT323', monospace;
            font-size: 20px;
            padding: 8px 25px;
            cursor: pointer;
            text-transform: uppercase;
            transition: all 0.3s ease;
        }

        .run-button:hover {
            box-shadow: 0 0 15px var(--green);
            transform: scale(1.05);
        }

        .run-button:disabled {
            background: #333;
            border-color: #666;
            color: #666;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }

        .run-button.running {
            background: linear-gradient(180deg, var(--yellow) 0%, #999900 100%);
            border-color: var(--yellow);
            animation: button-pulse 1s infinite;
        }

        @keyframes button-pulse {
            0%, 100% { box-shadow: 0 0 5px var(--yellow); }
            50% { box-shadow: 0 0 20px var(--yellow); }
        }

        .progress-container {
            flex: 1;
            margin: 0 25px;
            max-width: 500px;
        }

        .progress-label {
            color: var(--cyan);
            font-size: 12px;
            margin-bottom: 4px;
            display: flex;
            justify-content: space-between;
        }

        .progress-bar {
            height: 16px;
            background: var(--bg-dark);
            border: 2px solid var(--cyan);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--cyan), var(--green));
            transition: width 0.5s ease;
        }

        .status-text {
            color: var(--yellow);
            font-size: 16px;
            min-width: 180px;
            text-align: right;
        }

        .reset-button {
            background: transparent;
            border: 2px solid var(--red);
            color: var(--red);
            font-family: 'VT323', monospace;
            font-size: 16px;
            padding: 6px 15px;
            cursor: pointer;
            margin-left: 10px;
        }

        .reset-button:hover {
            background: var(--red);
            color: var(--white);
        }

        @media (max-width: 1100px) {
            .panel-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="logo">BANK//<span>IDEAS</span></div>
        <div class="header-info">
            AI AGENT PIPELINE VISUALIZER ‚Ä¢ <span style="color: var(--cyan);">Vercel AI SDK + GPT-4o-mini</span>
        </div>
        <div class="page-number">P.500</div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Pipeline Area -->
        <div class="pipeline-area">
            <div class="pipeline-stages" id="pipelineStages">
                <!-- INPUT -->
                <div class="stage-column">
                    <div class="stage-label">Input</div>
                    <div class="node input-node" data-node="input" data-stage="0">
                        <div class="node-icon">üìù</div>
                        <div class="node-title">Form Input</div>
                        <div class="node-subtitle">7-Step Form</div>
                        <div class="node-phase">START</div>
                        <div class="node-status waiting">WAITING</div>
                    </div>
                </div>

                <div class="stage-arrow" data-arrow="0">‚Üí</div>

                <!-- PHASE 1 -->
                <div class="stage-column">
                    <div class="stage-label">Phase 1</div>
                    <div class="node" data-node="analyzer" data-stage="1">
                        <div class="node-icon">üîç</div>
                        <div class="node-title">Content Analyzer</div>
                        <div class="node-subtitle">gpt-4o-mini</div>
                        <div class="node-phase">ANALYZE</div>
                        <div class="node-status waiting">WAITING</div>
                    </div>
                </div>

                <div class="stage-arrow" data-arrow="1">‚Üí</div>

                <!-- PHASE 2 - PARALLEL -->
                <div class="stage-column">
                    <div class="stage-label">Phase 2</div>
                    <div class="parallel-box">
                        <div class="node" data-node="designer" data-stage="2">
                            <div class="node-icon">üé®</div>
                            <div class="node-title">Page Designer</div>
                            <div class="node-subtitle">PageStructureSchema</div>
                            <div class="node-phase">2A</div>
                            <div class="node-status waiting">WAITING</div>
                        </div>
                        <div class="node" data-node="ascii" data-stage="2">
                            <div class="node-icon">‚ñì‚ñë‚ñí</div>
                            <div class="node-title">ASCII Art Gen</div>
                            <div class="node-subtitle">ASCIIElementsSchema</div>
                            <div class="node-phase">2B</div>
                            <div class="node-status waiting">WAITING</div>
                        </div>
                        <div class="node" data-node="copywriter" data-stage="2">
                            <div class="node-icon">‚úçÔ∏è</div>
                            <div class="node-title">Teletext Copy</div>
                            <div class="node-subtitle">40 char/line max</div>
                            <div class="node-phase">2C</div>
                            <div class="node-status waiting">WAITING</div>
                        </div>
                    </div>
                </div>

                <div class="stage-arrow" data-arrow="2">‚Üí</div>

                <!-- PHASE 3 -->
                <div class="stage-column">
                    <div class="stage-label">Phase 3</div>
                    <div class="node" data-node="renderer" data-stage="3">
                        <div class="node-icon">‚öôÔ∏è</div>
                        <div class="node-title">Page Renderer</div>
                        <div class="node-subtitle">HTML/CSS Assembly</div>
                        <div class="node-phase">RENDER</div>
                        <div class="node-status waiting">WAITING</div>
                    </div>
                </div>

                <div class="stage-arrow" data-arrow="3">‚Üí</div>

                <!-- OUTPUT -->
                <div class="stage-column">
                    <div class="stage-label">Output</div>
                    <div class="node output-node" data-node="output" data-stage="4">
                        <div class="node-icon">üì∫</div>
                        <div class="node-title">Teletext Pages</div>
                        <div class="node-subtitle">P.100, P.101...</div>
                        <div class="node-phase">END</div>
                        <div class="node-status waiting">WAITING</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Side Panel -->
        <div class="side-panel" id="sidePanel">
            <div class="panel-inner">
                <div class="panel-header">
                    <div class="panel-title" id="panelTitle">Node Details</div>
                    <button class="panel-close" onclick="closePanel()">‚úï CLOSE</button>
                </div>
                <div class="panel-content" id="panelContent"></div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <button class="run-button" id="runButton" onclick="runPipeline()">‚ñ∂ RUN PIPELINE</button>
        <div class="progress-container">
            <div class="progress-label">
                <span>PIPELINE PROGRESS</span>
                <span id="progressPercent">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>
        <div class="status-text" id="statusText">READY TO START</div>
        <button class="reset-button" onclick="resetPipeline()">‚Ü∫ RESET</button>
    </footer>

    <script>
        const nodeData = {
            input: {
                title: 'FORM INPUT',
                description: '7-step form collecting idea details with comprehensive Zod validation. Each step focuses on a different aspect of the banking innovation idea.',
                schema: `const IdeaFormSchema = z.object({
  // Step 1: Basic Info
  title: z.string().min(5).max(100),
  shortDescription: z.string().min(20).max(500),
  category: z.enum([
    'Customer Experience',
    'Internal Operations',
    'Digital Products',
    'Sustainability',
    'Security & Compliance'
  ]),
  problemSolved: z.string().min(50),

  // Step 2: Technologies
  technologies: z.array(z.string()),
  solutionType: z.string(),
  techStack: z.string().optional(),

  // Step 3: Business Context
  targetSegment: z.string(),
  monetizationModel: z.string(),

  // Step 4: Regulations
  regulations: z.array(z.string()),
  complianceNotes: z.string().optional(),

  // Step 5: Differentiators
  uniqueValue: z.string().min(50),
  projectStage: z.string(),
  githubLink: z.string().url().optional(),

  // Step 6: Additional
  team: z.string().optional(),
  additionalNotes: z.string().optional()
});`,
                details: [
                    { label: 'Steps', value: '7 sections' },
                    { label: 'Validation', value: 'Zod Schema' },
                    { label: 'Required', value: '12 fields' },
                    { label: 'Optional', value: '8 fields' }
                ]
            },
            analyzer: {
                title: 'CONTENT ANALYZER AGENT',
                description: 'Analyzes form input using GPT-4o-mini and extracts key themes, sentiment, and categories for intelligent page generation.',
                schema: `const ContentAnalysisSchema = z.object({
  mainTheme: z.string(),
  subThemes: z.array(z.string()).max(5),
  sentiment: z.enum([
    'innovative', 'practical', 
    'disruptive', 'incremental'
  ]),
  
  primaryCategory: z.string(),
  targetAudience: z.array(z.string()),
  keyBenefits: z.array(z.string()).max(6),
  
  technicalComplexity: z.enum([
    'low', 'medium', 'high'
  ]),
  
  suggestedPages: z.number().min(2).max(5),
  contentBlocks: z.array(z.object({
    type: z.enum(['header', 'body', 'list', 'stats']),
    priority: z.number(),
    content: z.string()
  }))
});`,
                code: `import { generateObject } from 'ai';
import { openai } from '@ai-sdk/openai';

const { object: analysis } = await generateObject({
  model: openai('gpt-4o-mini'),
  schema: ContentAnalysisSchema,
  prompt: \`Analyze this banking idea:
Title: \${idea.title}
Description: \${idea.shortDescription}\`
});`,
                details: [
                    { label: 'Model', value: 'gpt-4o-mini' },
                    { label: 'Method', value: 'generateObject()' },
                    { label: 'Temperature', value: '0.7' },
                    { label: 'Tokens', value: '~1000' }
                ]
            },
            designer: {
                title: 'PAGE DESIGNER AGENT',
                description: 'Creates page layout structure optimized for Teletext grid (40√ó25). Runs in PARALLEL.',
                schema: `const PageStructureSchema = z.object({
  pages: z.array(z.object({
    pageNumber: z.number(),
    title: z.string().max(40),
    layout: z.enum([
      'single-column',
      'two-column',
      'header-body-footer'
    ]),
    sections: z.array(z.object({
      type: z.enum(['header', 'body', 'list', 'box']),
      row: z.number().min(1).max(25),
      col: z.number().min(1).max(40),
      width: z.number().max(40),
      color: z.enum(['cyan', 'yellow', 'magenta', 'green']),
      content: z.string()
    })),
    navigation: z.object({
      prev: z.number().optional(),
      next: z.number().optional()
    })
  }))
});`,
                details: [
                    { label: 'Grid', value: '40√ó25 chars' },
                    { label: 'Colors', value: '6 Teletext' },
                    { label: 'Layouts', value: '3 templates' },
                    { label: 'Execution', value: 'PARALLEL' }
                ]
            },
            ascii: {
                title: 'ASCII ART GENERATOR',
                description: 'Generates ASCII art elements, borders, and decorations for authentic Teletext visual appeal.',
                schema: `const ASCIIElementsSchema = z.object({
  elements: z.array(z.object({
    name: z.string(),
    type: z.enum(['logo', 'border', 'icon', 'divider']),
    art: z.array(z.string().max(40)),
    width: z.number().max(40),
    height: z.number().max(10)
  })),
  borders: z.object({
    topLeft: z.string().length(1),
    topRight: z.string().length(1),
    bottomLeft: z.string().length(1),
    bottomRight: z.string().length(1),
    horizontal: z.string().length(1),
    vertical: z.string().length(1)
  })
});`,
                code: `// Generated ASCII Art:
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó  ‚ïë
‚ïë  ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ïë
‚ïë  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë
‚ïë  ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïù‚ïë
‚ïë  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

// Symbols: ‚òÖ ‚óè ‚ñ∂ ‚ñ† ‚ñà ‚ñë ‚ñí ‚ñì`,
                details: [
                    { label: 'Max Width', value: '40 chars' },
                    { label: 'Max Height', value: '10 lines' },
                    { label: 'Char Set', value: 'Box Drawing' },
                    { label: 'Execution', value: 'PARALLEL' }
                ]
            },
            copywriter: {
                title: 'TELETEXT COPYWRITER',
                description: 'Writes concise copy optimized for 40-character line width with authentic Teletext style.',
                schema: `const TeletextCopySchema = z.object({
  pages: z.array(z.object({
    pageNumber: z.number(),
    headline: z.string().max(40),
    subheadline: z.string().max(40).optional(),
    bodyBlocks: z.array(z.object({
      text: z.array(z.string().max(40)),
      style: z.enum(['normal', 'highlight'])
    })),
    bulletPoints: z.array(z.string().max(38)),
    callToAction: z.string().max(40).optional()
  })),
  metadata: z.object({
    wordCount: z.number(),
    tone: z.enum(['professional', 'innovative'])
  })
});`,
                code: `// Teletext Copy Rules:
// ‚Ä¢ Max 40 characters per line
// ‚Ä¢ UPPERCASE for headers
// ‚Ä¢ Short sentences

// Example:
"REVOLUTIONARY AI-POWERED BANKING"
"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
"Transform your financial future"
""
"‚òÖ 24/7 Intelligent Support"
"‚òÖ Real-time Fraud Detection"`,
                details: [
                    { label: 'Max Line', value: '40 chars' },
                    { label: 'Tone', value: 'Professional' },
                    { label: 'Style', value: 'Teletext Classic' },
                    { label: 'Execution', value: 'PARALLEL' }
                ]
            },
            renderer: {
                title: 'PAGE RENDERER AGENT',
                description: 'Assembles final HTML/CSS pages from Phase 2 outputs. Runs SEQUENTIALLY after all parallel agents complete.',
                schema: `const RenderedPageSchema = z.object({
  pages: z.array(z.object({
    pageNumber: z.number(),
    html: z.string(),
    css: z.string().optional(),
    metadata: z.object({
      title: z.string(),
      generatedAt: z.string()
    }),
    validation: z.object({
      isValid: z.boolean(),
      errors: z.array(z.string())
    })
  }))
});`,
                code: `// Sequential - Waits for Phase 2
const [structure, ascii, copy] = 
  await Promise.all([
    pageDesignerAgent(analysis),
    asciiArtAgent(analysis),
    copywriterAgent(analysis)
  ]);

// Phase 3: Render
const rendered = await generateObject({
  model: openai('gpt-4o-mini'),
  schema: RenderedPageSchema,
  prompt: \`Assemble Teletext pages from:
STRUCTURE: \${JSON.stringify(structure)}
ASCII: \${JSON.stringify(ascii)}
COPY: \${JSON.stringify(copy)}\`
});`,
                details: [
                    { label: 'Execution', value: 'SEQUENTIAL' },
                    { label: 'Waits For', value: 'All Phase 2' },
                    { label: 'Output', value: 'HTML + CSS' },
                    { label: 'Storage', value: 'PostgreSQL' }
                ]
            },
            output: {
                title: 'TELETEXT PAGES OUTPUT',
                description: 'Final generated Teletext-style pages stored in PostgreSQL and accessible via page viewer.',
                schema: `// Generated Pages
{
  "pages": [
    { "pageNumber": 100, "title": "OVERVIEW" },
    { "pageNumber": 101, "title": "PROBLEM" },
    { "pageNumber": 102, "title": "TECH STACK" },
    { "pageNumber": 103, "title": "BUSINESS" }
  ]
}`,
                code: `// Page Viewer
<TeletextViewer 
  pages={idea.generatedPages}
  initialPage={100}
/>

// URLs
/ideas/[id]/page/100  ‚Üí Overview
/ideas/[id]/page/101  ‚Üí Problem
/ideas/[id]/page/102  ‚Üí Tech
/ideas/[id]/page/103  ‚Üí Business`,
                details: [
                    { label: 'Pages', value: '2-5 per idea' },
                    { label: 'Format', value: 'HTML + CSS' },
                    { label: 'Nav', value: 'P.100 ‚Üí P.10X' },
                    { label: 'Storage', value: 'PostgreSQL' }
                ]
            }
        };

        let isRunning = false;
        let selectedNode = null;

        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.node').forEach(node => {
                node.addEventListener('click', () => selectNode(node));
            });
        });

        function selectNode(node) {
            document.querySelectorAll('.node.selected').forEach(n => n.classList.remove('selected'));
            node.classList.add('selected');
            selectedNode = node.dataset.node;
            showNodeDetails(selectedNode);
        }

        function showNodeDetails(nodeId) {
            const data = nodeData[nodeId];
            if (!data) return;

            document.getElementById('panelTitle').textContent = data.title;
            
            let html = `
                <div>
                    <p class="panel-description">${data.description}</p>
                    <div class="panel-section">
                        <div class="panel-section-title">Configuration</div>
                        <ul class="info-list">
                            ${data.details.map(d => `
                                <li><span class="info-label">${d.label}</span><span class="info-value">${d.value}</span></li>
                            `).join('')}
                        </ul>
                    </div>
                </div>
                <div>
                    <div class="panel-section">
                        <div class="panel-section-title">Zod Schema</div>
                        <div class="code-block"><code>${escapeHtml(data.schema)}</code></div>
                    </div>
                    ${data.code ? `
                    <div class="panel-section">
                        <div class="panel-section-title">Code</div>
                        <div class="code-block"><code>${escapeHtml(data.code)}</code></div>
                    </div>` : ''}
                </div>
            `;

            document.getElementById('panelContent').innerHTML = html;
            document.getElementById('sidePanel').classList.add('open');
        }

        function closePanel() {
            document.getElementById('sidePanel').classList.remove('open');
            document.querySelectorAll('.node.selected').forEach(n => n.classList.remove('selected'));
        }

        async function runPipeline() {
            if (isRunning) return;
            isRunning = true;
            
            const btn = document.getElementById('runButton');
            const status = document.getElementById('statusText');
            
            btn.disabled = true;
            btn.classList.add('running');
            btn.textContent = '‚ü≥ RUNNING...';

            await runStage(0, ['input'], 'Processing input...', 10);
            await runStage(1, ['analyzer'], 'Analyzing content...', 30);
            await runStage(2, ['designer', 'ascii', 'copywriter'], 'Parallel agents...', 70, true);
            await runStage(3, ['renderer'], 'Rendering pages...', 90);
            await runStage(4, ['output'], 'Complete!', 100);

            status.textContent = '‚úì PIPELINE COMPLETE';
            status.style.color = 'var(--green)';
            btn.classList.remove('running');
            btn.textContent = '‚úì COMPLETE';
            isRunning = false;
        }

        async function runStage(stageNum, nodeIds, msg, progress, parallel = false) {
            document.getElementById('statusText').textContent = msg;

            if (stageNum > 0) {
                const arrow = document.querySelector(`[data-arrow="${stageNum - 1}"]`);
                if (arrow) arrow.classList.add('active');
            }

            nodeIds.forEach(id => {
                const node = document.querySelector(`[data-node="${id}"]`);
                node.classList.add('running');
                node.querySelector('.node-status').textContent = 'RUNNING';
                node.querySelector('.node-status').className = 'node-status running';
            });

            await sleep(parallel ? 2000 : 1500);

            nodeIds.forEach(id => {
                const node = document.querySelector(`[data-node="${id}"]`);
                node.classList.remove('running');
                node.classList.add('complete');
                node.querySelector('.node-status').textContent = 'COMPLETE';
                node.querySelector('.node-status').className = 'node-status complete';
            });

            if (stageNum > 0) {
                const arrow = document.querySelector(`[data-arrow="${stageNum - 1}"]`);
                if (arrow) {
                    arrow.classList.remove('active');
                    arrow.classList.add('complete');
                }
            }

            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressPercent').textContent = progress + '%';
            await sleep(300);
        }

        function resetPipeline() {
            if (isRunning) return;

            document.querySelectorAll('.node').forEach(node => {
                node.classList.remove('running', 'complete', 'selected');
                node.querySelector('.node-status').textContent = 'WAITING';
                node.querySelector('.node-status').className = 'node-status waiting';
            });

            document.querySelectorAll('.stage-arrow').forEach(a => a.classList.remove('active', 'complete'));
            
            document.getElementById('progressFill').style.width = '0%';
            document.getElementById('progressPercent').textContent = '0%';
            
            const btn = document.getElementById('runButton');
            btn.disabled = false;
            btn.classList.remove('running');
            btn.textContent = '‚ñ∂ RUN PIPELINE';
            
            document.getElementById('statusText').textContent = 'READY TO START';
            document.getElementById('statusText').style.color = 'var(--yellow)';
            
            closePanel();
        }

        function sleep(ms) { return new Promise(r => setTimeout(r, ms)); }
        
        function escapeHtml(t) {
            return t.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
        }
    </script>
</body>
</html>
